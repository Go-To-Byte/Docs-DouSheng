(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{418:function(t,s,a){"use strict";a.r(s);var n=a(2),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"grpcå®˜æ–¹çš„errorå¤„ç†-æˆ‘æ”¾åœ¨httpä¸­1æ ·çš„å¥½ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#grpcå®˜æ–¹çš„errorå¤„ç†-æˆ‘æ”¾åœ¨httpä¸­1æ ·çš„å¥½ç”¨"}},[t._v("#")]),t._v(" GRPCå®˜æ–¹çš„errorå¤„ç†ï¼Œæˆ‘æ”¾åœ¨HTTPä¸­1æ ·çš„å¥½ç”¨")]),t._v(" "),s("p",[s("code",[t._v("Go")]),t._v("çš„erroræœºåˆ¶ï¼Œå¯èƒ½è¢«åæ§½å¾—ç®—å¤šçš„äº†ã€‚è¿™é‡Œå°±ä¸åæ§½äº†ã€‚æ—¢ç„¶è¦æ¥åšç»Ÿä¸€çš„errorå¤„ç†ã€‚")]),t._v(" "),s("p",[t._v("æ—¢ç„¶è¦æ¥åšç»Ÿä¸€çš„"),s("code",[t._v("error")]),t._v("å¤„ç†ã€‚åœ¨è¿™ä¹‹å‰ï¼Œä½ æ€»çš„å‘Šè¯‰æˆ‘ï¼Œä¸ºä»€ä¹ˆéœ€è¦åšå¼‚å¸¸å¤„ç†å§ï¼ä¸å¯èƒ½è¯´å› ä¸ºæŸæŸè¯´ï¼š"),s("s",[s("em",[t._v("ä¸€ä¸ªåç«¯é¡¹ç›®ä¸­ï¼Œä¸èƒ½ç¼ºå°‘å¼‚å¸¸å¤„ç†å“Ÿï¼Œæ²¡æœ‰çš„è¯ï¼Œå¯...")])])]),t._v(" "),s("p",[t._v("è¿™æ ·å¯ä¸è¡Œï¼Œå’±ä»¬è¿˜æ˜¯æ¥çœ‹çœ‹ï¼Œä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€errorå¤„ç†ã€‚")]),t._v(" "),s("h2",{attrs:{id:"ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€errorå¤„ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€errorå¤„ç†"}},[t._v("#")]),t._v(" ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€errorå¤„ç†ï¼Ÿ")]),t._v(" "),s("p",[t._v("æ—¢ç„¶æˆ‘ä»¬ä¸»è¦æ˜¯å¤„ç†"),s("code",[t._v("HTTP Handlerçš„error")]),t._v("ï¼Œé‚£å…ˆæ¥çœ‹çœ‹ï¼Œæˆ‘è®¤ä¸ºçš„ï¼Œä¼˜é›…çš„Handlerå±‚çš„ä»£ç é•¿ä»€ä¹ˆæ ·ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_1-æˆ‘è®¤ä¸ºçš„ä¼˜é›…çš„handlerå±‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-æˆ‘è®¤ä¸ºçš„ä¼˜é›…çš„handlerå±‚"}},[t._v("#")]),t._v(" ï¼ˆ1ï¼‰æˆ‘è®¤ä¸ºçš„ä¼˜é›…çš„Handlerå±‚")]),t._v(" "),s("h4",{attrs:{id:"_1ã€æ˜¯è¿™æ ·çš„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€æ˜¯è¿™æ ·çš„"}},[t._v("#")]),t._v(" 1ã€æ˜¯è¿™æ ·çš„")]),t._v(" "),s("p",[t._v("å…ˆè¯´ç»“è®ºï¼Œæˆ‘è®¤ä¸ºï¼ŒHandlerå±‚æ ¸å¿ƒåº”è¯¥åªåšä¸‰ä»¶äº‹ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("å¤„ç†ä»€ä¹ˆuri")]),t._v(" "),s("li",[t._v("æ¥æ”¶è¯·æ±‚å‚æ•°&æå–é¢å¤–å‚æ•°ï¼Œå»è°ƒç”¨ä¸šåŠ¡æ–¹æ³•ï¼Œæ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚")]),t._v(" "),s("li",[t._v("æ‹¿åˆ°ä¸Šä¸€æ­¥è°ƒç”¨è¿”å›çš„ç»“æœï¼Œè¿›è¡Œå“åº”ã€‚")])]),t._v(" "),s("p",[t._v("ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘çš„ç†ç”±å¦‚ä¸‹ï¼Œå¬æˆ‘ç»†ç»†é“æ¥ã€‚")]),t._v(" "),s("p",[t._v("ä¸å…¶è¯´æ˜¯å¤„ç†HTTPçš„Handlerï¼Œè¿˜ä¸å¦‚è¯´æ˜¯å¤„ç†HTTPçš„æŠ¥æ–‡"),s("code",[t._v("ï¼ˆHTTP Messageï¼‰")]),t._v("ã€‚ç®€å•æ¥äº†è§£ä¸€ä¸‹"),s("a",{attrs:{href:"https://juejin.cn/post/7117192792446599199",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTPçš„æŠ¥æ–‡æ ¼å¼"),s("OutboundLink")],1),t._v("ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86dce1f72aae4ec2861cc3b8396d1f80~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20230224151222317"}})]),t._v(" "),s("p",[t._v("çœ‹äº†å›¾ï¼Œæœ‰ç‚¹æ‡µæ²¡å…³ç³»ï¼Œæˆ‘å°±æƒ³è¯´ï¼šHTTP æŠ¥æ–‡æ ¼å¼ï¼Œæ ¸å¿ƒå°±æ˜¯è¿™ä¸‰éƒ¨åˆ†"),s("code",[t._v("ï¼ˆstart-lineã€headerã€bodyï¼‰")])]),t._v(" "),s("p",[t._v("æ—¢ç„¶æŠ¥æ–‡é•¿è¿™æ ·ï¼Œé‚£ä¹ˆHTTPçš„Handlerï¼Œæ ¸å¿ƒè‡³å°‘ä¹Ÿå¾—å¤„ç†è¿™ä¸‰éƒ¨åˆ†å§ï¼Œç”¨ä¸€å¹…å›¾ç‰‡ç®€å•å¯¹åº”ä¸€ä¸‹ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c2ea8844f312440f934eb9113fc8c15e~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20230224152826933"}})]),t._v(" "),s("p",[t._v("å¥½äº†ï¼Œæˆ‘çš„ç†ç”±å™è¿°å®Œäº†ï¼Œå†æ¥åˆ†åˆ«çœ‹çœ‹æˆ‘ç»™çš„ç»“è®ºï¼š")]),t._v(" "),s("h4",{attrs:{id:"_2ã€å¤„ç†ä»€ä¹ˆuri"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€å¤„ç†ä»€ä¹ˆuri"}},[t._v("#")]),t._v(" 2ã€å¤„ç†ä»€ä¹ˆURI")]),t._v(" "),s("p",[t._v("è¿™ä¸ªæ˜¯åœ¨å®šä¹‰HandlerFuncçš„æ—¶å€™ï¼Œå°±éœ€è¦å®šä¹‰çš„ï¼Œæ­¤æ–¹æ³•åˆ°åº•è´Ÿè´£å“ªä¸ªè¯·æ±‚ï¼Ÿè´Ÿè´£ä»€ä¹ˆURIï¼Ÿæ¯”å¦‚æˆ‘ä»¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯Ginå°è£…çš„"),s("code",[t._v("HTTP Servce")]),t._v("ï¼š")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Registry ç”¨äºæ³¨å†ŒHandleræ‰€éœ€è¦æš´éœ²çš„è·¯ç”±")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("h "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("Handler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Registry")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r gin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IRoutes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("POST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/register/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Register"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("POST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/login/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Login"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetUserInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œåœ¨æ·»åŠ è·¯ç”±çš„æ—¶å€™ï¼Œä¸å°±æ˜¯åœ¨å¤„ç†è¿™ä¸ªå‡½æ•°å¤„ç†ä»€ä¹ˆURIå—ï¼Ÿ")]),t._v(" "),s("h4",{attrs:{id:"_3ã€æ¥æ”¶è¯·æ±‚å‚æ•°-æå–é¢å¤–å‚æ•°-å»è°ƒç”¨ä¸šåŠ¡æ–¹æ³•-æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€æ¥æ”¶è¯·æ±‚å‚æ•°-æå–é¢å¤–å‚æ•°-å»è°ƒç”¨ä¸šåŠ¡æ–¹æ³•-æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚"}},[t._v("#")]),t._v(" 3ã€æ¥æ”¶è¯·æ±‚å‚æ•°&æå–é¢å¤–å‚æ•°ï¼Œå»è°ƒç”¨ä¸šåŠ¡æ–¹æ³•ï¼Œæ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚")]),t._v(" "),s("p",[t._v("æ¯”å¦‚æ‹¿ç™»å½•è¿™ä¸ªç®€å•çš„ä¸šåŠ¡æ¥ä¸¾ä¾‹ï¼Œç”¨æˆ·è¦ç™»é™†ï¼Œè‡³å°‘è¦æä¾›ç”¨æˆ·åå’Œå¯†ç è¿™ä¸¤ä¸ªå‚æ•°å§ã€‚é‚£è¿™ä¸¤ä¸ªå‚æ•°æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿï¼šæ˜¯è¯·æ±‚å¤´ï¼Ÿè¯·æ±‚ä½“ï¼Ÿè¿˜æ˜¯query stringä¸­å‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("åæ­£ä¸ç®¡æ˜¯å“ªé‡Œï¼Œä½ æ€»çš„æŠŠä»–ä»HTTPçš„æŠ¥æ–‡ä¸­è§£æå‡ºæ¥ï¼Œè¿™ä¸å°±æ˜¯åœ¨å¤„ç†Headerå’ŒBodyå—ï¼Ÿ")]),t._v(" "),s("p",[t._v("æ‹¿åˆ°äº†è¿™äº›å‚æ•°è¿‡åï¼Œå°±å¯ä»¥å»è°ƒç”¨ä½ çš„ä¸šåŠ¡æ–¹æ³•äº†ã€‚")]),t._v(" "),s("p",[t._v("psï¼šå½“ç„¶å•Šï¼Œæˆ‘ä¹Ÿè§è¿‡æœ‰ä¸€äº›ä»£ç ï¼Œåœ¨Handleré‡Œè¿›è¡Œäº†å¤§é‡çš„ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ï¼Œç”šè‡³è¿˜æœ‰çš„ç›´æ¥åœ¨è¿™é‡Œå»æ“çºµæ•°æ®åº“ã€‚ä¸æ˜¯è¯´ä¸è¡Œå•Šï¼Œä½†çš„ç¡®ä¸å¤ªæ¨è~")]),t._v(" "),s("h4",{attrs:{id:"_4ã€æ‹¿åˆ°ä¸Šä¸€æ­¥è°ƒç”¨è¿”å›çš„ç»“æœ-è¿›è¡Œå“åº”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4ã€æ‹¿åˆ°ä¸Šä¸€æ­¥è°ƒç”¨è¿”å›çš„ç»“æœ-è¿›è¡Œå“åº”"}},[t._v("#")]),t._v(" 4ã€æ‹¿åˆ°ä¸Šä¸€æ­¥è°ƒç”¨è¿”å›çš„ç»“æœï¼Œè¿›è¡Œå“åº”")]),t._v(" "),s("p",[t._v("ç»è¿‡å‰ä¸¤ä¸ªæ­¥éª¤åï¼Œä¸ç®¡è°ƒç”¨ä¸šåŠ¡é€»è¾‘æˆåŠŸä¸å¦ï¼Œå®ƒéƒ½ä¼šå®ƒè¿”å›ä¸€äº›æ•°æ®ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨è¿™äº›æ•°æ®ï¼Œä½œä¸ºå¯¹åº”çš„å“åº”ã€‚")]),t._v(" "),s("p",[t._v("è€Œå“åº”ä¹Ÿæ˜¯ä¸€åˆ™HTTPæŠ¥æ–‡ï¼Œé‚£å®ƒä¹Ÿéœ€è¦ç»„è£…HTTPä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒï¼š"),s("code",[t._v("ï¼ˆstart-lineã€headerã€bodyï¼‰")])]),t._v(" "),s("p",[t._v("å¤§è‡´å°±æ˜¯ï¼šè¿›è¡Œå“åº”çš„çŠ¶æ€ç æ˜¯ä»€ä¹ˆå•Šã€‚éœ€ä¸éœ€è¦æ·»åŠ æ•°æ®åˆ°å“åº”çš„Headerå•Šã€‚æœ‰æ²¡æœ‰Bodyæ•°æ®è¦è¿”å›å•Š...")]),t._v(" "),s("h3",{attrs:{id:"_2-é‚£ç°åœ¨ä¼˜é›…äº†å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-é‚£ç°åœ¨ä¼˜é›…äº†å—"}},[t._v("#")]),t._v(" ï¼ˆ2ï¼‰é‚£ç°åœ¨ä¼˜é›…äº†å—ï¼Ÿ")]),t._v(" "),s("p",[t._v("å¥½äº†ï¼Œä»‹ç»å®Œäº†æˆ‘è®¤ä¸ºæ¯”è¾ƒä¼˜é›…çš„HTTP Handlerä»£ç ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»¥"),s("code",[t._v("Loginçš„HandlerFunc")]),t._v("ä¸ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("h "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("Handler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Login")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("gin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\treq "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewLoginAndRegisterRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1ã€æ¥æ”¶å‚æ•°")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Bind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tmsg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3ã€è‹¥å¤±è´¥ã€å“åº”é”™è¯¯ç»“æœ")]),t._v("\n\t\tc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusBadRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TokenResponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tStatusCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\tStatusMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2ã€è¿›è¡Œæ¥å£è°ƒç”¨")]),t._v("\n\tresp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Login")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tmsg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3ã€è‹¥å¤±è´¥ã€å“åº”é”™è¯¯ç»“æœ")]),t._v("\n\t\tc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusBadRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TokenResponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tStatusCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\tStatusMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\tresp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\t\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3ã€å“åº”æ­£ç¡®ç»“æœ")]),t._v("\n\tc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusBadRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("ä¸Šé¢çš„ä»£ç ï¼Œçœ‹å¤§è‡´é€»è¾‘å°±å¥½ã€‚ä½ è§‰å¾—ä¼˜é›…äº†å—ï¼Ÿå¥½åƒæ»¡è¶³äº†æˆ‘æ‰€è¯´çš„"),s("code",[t._v("HTTPçš„Handler")]),t._v("åªåšä¸‰ä»¶äº‹å“ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("å¤„ç†ä»€ä¹ˆuri")]),t._v(" "),s("li",[t._v("æ¥æ”¶è¯·æ±‚å‚æ•°&æå–é¢å¤–å‚æ•°ï¼Œå»è°ƒç”¨ä¸šåŠ¡æ–¹æ³•ï¼Œæ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚")]),t._v(" "),s("li",[t._v("æ‹¿åˆ°ä¸Šä¸€æ­¥è°ƒç”¨è¿”å›çš„ç»“æœï¼Œè¿›è¡Œå“åº”ã€‚")])]),t._v(" "),s("p",[t._v("emmï¼Œç›¸æ¯”äºå¤§å¤šæ•°åœ¨æ§åˆ¶å±‚å†™äº†å¤§é‡ä¸šåŠ¡é€»è¾‘çš„ä»£ç ï¼Œå¤§ä½“ä¸Šçš„ç¡®è¿˜ç®—æ¯”è¾ƒä¼˜é›…äº†ã€‚ä½†ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œå…¶ä¸­æœ‰å¥½å‡ ä¸ªåœ°æ–¹ï¼Œå¦‚æœ"),s("code",[t._v("err != nil")]),t._v("ï¼Œæˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œå½¢å¦‚è¿™æ ·çš„å“åº”ï¼š")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[t._v("\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tmsg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3ã€è‹¥å¤±è´¥ã€å“åº”é”™è¯¯ç»“æœ")]),t._v("\n\t\tc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusBadRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TokenResponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tStatusCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\tStatusMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è°æƒ³æœ‰äº‹æ²¡äº‹å°±ç¢°åˆ°errorå•Šï¼Œæˆ‘ä»¬æƒ³è¦çš„æµç¨‹æ˜æ˜æ˜¯ï¼š"),s("strong",[t._v("æ¥æ”¶ç”¨æˆ·è¯·æ±‚ -> å¤„ç†ä¸šåŠ¡é€»è¾‘ -> è¿”å›æˆåŠŸå“åº”")])]),t._v(" "),s("p",[t._v("å¯åååŠè·¯æ€å‡ºæ¥ä¸€ä¸ª"),s("code",[t._v("error")]),t._v("å¾ˆå˜²è®½çš„è¯´ï¼šä½ åœ¨è°ƒç”¨æˆ‘çš„æ—¶å€™å‡ºé”™äº†ï¼Œä½ è‡ªå·±æƒ³æƒ³æ€ä¹ˆå¤„ç†æˆ‘å§ã€‚è¦ä¸ç„¶æˆ‘å¯ä¸è®©ä½ å¥½è¿‡ï¼ï¼ï¼")]),t._v(" "),s("p",[t._v("äºæ˜¯å°±å‡ºç°äº†ä¸Šé¢çš„ä»£ç ã€‚é‚£æˆ‘ä»¬æœ‰æ²¡æœ‰åŠæ³•ï¼Œè®©ä»–ç¨å¾®ä¼˜é›…ä¸€äº›å‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("ç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œè¿™å°±å¼•å‡ºäº†æˆ‘ä»¬ä»Šå¤©çš„ç©¶æä¸»é¢˜ï¼š"),s("strong",[t._v("ç»Ÿä¸€çš„"),s("code",[t._v("error")]),t._v("å¤„ç†")])]),t._v(" "),s("h2",{attrs:{id:"äºŒã€æˆ‘ä»¬æ˜¯è¿™æ ·åšçš„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€æˆ‘ä»¬æ˜¯è¿™æ ·åšçš„"}},[t._v("#")]),t._v(" äºŒã€æˆ‘ä»¬æ˜¯è¿™æ ·åšçš„")]),t._v(" "),s("h3",{attrs:{id:"_1-å¤„ç†å‰å‡†å¤‡ä¸€äº›ä¸œè¥¿"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¤„ç†å‰å‡†å¤‡ä¸€äº›ä¸œè¥¿"}},[t._v("#")]),t._v(" ï¼ˆ1ï¼‰å¤„ç†å‰å‡†å¤‡ä¸€äº›ä¸œè¥¿")]),t._v(" "),s("h4",{attrs:{id:"_1ã€å“åº”ä¿¡æ¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€å“åº”ä¿¡æ¯"}},[t._v("#")]),t._v(" 1ã€å“åº”ä¿¡æ¯")]),t._v(" "),s("p",[t._v("ä¸€èˆ¬ä¸å¤–ç•Œäº¤äº’å“åº”ä¿¡æ¯ä¸­ï¼Œéƒ½ä¼šæœ‰å“åº”ç å’Œæç¤ºæ¶ˆæ¯ã€‚å¹¶ä¸”æˆ‘ä»¬è¿˜å¯ä»¥é¢„å®šä¹‰ä¸€äº›ä¸€ä¸€å¯¹åº”çš„codeå’Œmsgã€‚")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("å®šä¹‰ç»“æ„ä½“")])])]),t._v(" "),s("p",[t._v("ä¸ºäº†æ–¹ä¾¿å°è£…ï¼Œæˆ‘ä»¬ä¹Ÿé‡‡ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥åšäº†ï¼Œå®šä¹‰å¦‚ä¸‹çš„ç»“æ„ä½“ã€‚")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" CodeMsg "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// çŠ¶æ€ç ")]),t._v("\n   StatusCode "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int32")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('`json:"status_code"`')]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¶ˆæ¯")]),t._v("\n   StatusMsg "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('`json:"status_msg"`')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[t._v("æ­¤å“åº”æç¤ºï¼Œå°±åŒ…å«äº† code å’Œ msgï¼Œä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘ä»¬æ¥ç»™ä¸€äº›åˆå§‹åŒ–çš„æ„é€ æ–¹æ³•å§")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("strong",[t._v("å¥½ç”¨çš„æ„é€ æ–¹æ³•")])])]),t._v(" "),s("p",[t._v("éƒ½æ˜¯äº›ç®€å•çš„æ„é€ æ–¹æ³•ï¼Œå°±ä¸ä¸€ä¸€è´´å‡ºæ¥äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹é¡¹ç›®æºç é¸­~")]),t._v(" "),s("p",[t._v("ä½†æ˜¯ä¸ºäº†ä¹‹åä½¿ç”¨æ–¹ä¾¿ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•è¿˜æ˜¯å€¼å¾—ä¸€æã€‚æˆ‘ä»¬åˆšæåˆ°ï¼Œå¯ä»¥é¢„å®šä¹‰ä¸€äº›çš„CodeMsgã€‚å°±åƒä½¿ç”¨Javaçš„æšä¸¾ç±»ä¸€æ ·ã€‚")]),t._v(" "),s("p",[t._v("è€Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ¥é…åˆé¢„å®šä¹‰çš„æšä¸¾ä½¿ç”¨çš„ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥åŒå‘è§£æ "),s("code",[t._v("code <â€”â€”> msg")]),t._v("ã€‚ä»è€Œä½¿ç”¨é¢„å®šä¹‰çš„å€¼ã€‚")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// NewWithMsg æ ¹æ®msgåˆå§‹åŒ–ã€‚")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨ï¼šå¦‚æœä¼ å…¥çš„msgä¸æ˜¯é¢„å®šä¹‰çš„msgï¼Œé‚£ä¹ˆcodeï¼š1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewWithMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("CodeMsg "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Msg2Code")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// NewWithCode æ ¹æ®StatusCodeåˆå§‹åŒ–ã€‚")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// æ³¨ï¼šå¦‚æœä¼ å…¥çš„StatusCodeä¸æ˜¯é¢„å®šä¹‰çš„codeï¼Œé‚£ä¹ˆmsgï¼šfmt.Sprintf("æœªçŸ¥é”™è¯¯ï¼Œcode = %d", code)')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewWithCode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("CodeMsg "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewWithMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Code2Msg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("psï¼šé¡ºå¸¦æä¸€å˜´ï¼Œ"),s("code",[t._v("Goè¯­è¨€")]),t._v("ä¸èƒ½å†™é‡è½½æ–¹æ³•ï¼Œæœ‰æ—¶å€™çœŸçš„å¥½éš¾æƒ³åå­—å•Šã€‚ğŸ˜’ğŸ˜’")]),t._v(" "),s("h4",{attrs:{id:"_2ã€é¢„å®šä¹‰æšä¸¾"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€é¢„å®šä¹‰æšä¸¾"}},[t._v("#")]),t._v(" 2ã€é¢„å®šä¹‰æšä¸¾")]),t._v(" "),s("p",[t._v("æœ¬æ¥ä¸€å¼€å§‹æ˜¯ç›´æ¥ä½¿ç”¨å¯¹è±¡æ¥å†™çš„æšä¸¾ï¼Œä½†æ˜¯åé¢å‘ç°ã€‚è¿™äº›é¢„å®šä¹‰çš„æšä¸¾å€¼ï¼Œéƒ½æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œç”¨Mapåšå¯èƒ½ä¼šæ›´å¥½ã€‚å½“ç„¶ï¼Œè¿™é‡Œå€Ÿé‰´äº†GRPCçš„å¼‚å¸¸å¤„ç†ã€‚å¾€åçœ‹çœ‹ä½ å°±çŸ¥é“äº†ã€‚")]),t._v(" "),s("p",[t._v("æ‰€ä»¥åšäº†å½¢å¦‚ä¸‹é¢çš„æšä¸¾å€¼ã€‚")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// çº¦æŸæšä¸¾å€¼")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" StatusCode "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int32")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\tOPERATE_OK StatusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    \n\tERROR_OPERATE        StatusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40001")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" msgToCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("StatusCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"æ“ä½œæˆåŠŸ"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OPERATE_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"æ“ä½œå¤±è´¥"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("      ERROR_OPERATE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_3ã€å¼‚å¸¸å¯¹è±¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€å¼‚å¸¸å¯¹è±¡"}},[t._v("#")]),t._v(" 3ã€å¼‚å¸¸å¯¹è±¡")]),t._v(" "),s("p",[t._v("å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¸€èˆ¬ä¼šè¿›è¡Œé”™è¯¯çš„å“åº”ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°ä¸Šé¢çš„æšä¸¾ï¼Œæ¥çœ‹çœ‹å¦‚ä½•å®šä¹‰å¼‚å¸¸å¯¹è±¡çš„å§ã€‚")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("å®šä¹‰ä¸€ä¸ªå¼‚å¸¸å¯¹è±¡")])])]),t._v(" "),s("p",[t._v("ä¸»è¦å°±æ˜¯æä¾›CodeMsgï¼Œå½“ç„¶ï¼Œè¿™é‡Œæ¨¡ä»¿"),s("code",[t._v("GRPC")]),t._v("çš„æ–¹å¼ï¼Œå¯ä»¥è®©åœ¨æŠ›errçš„æ—¶å€™ï¼Œæºå¸¦ä¸€äº›é¢å¤–çš„ä¿¡æ¯"),s("code",[t._v("Details")]),t._v("ã€‚")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" Exception "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   S "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("CodeMsg\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯æºå¸¦é¢å¤–æ¶ˆæ¯")]),t._v("\n   Details "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('`json:"details"`')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("ç»™ä»–æ„é€ æ–¹æ³•")])]),t._v(" "),s("p",[t._v("æ ¸å¿ƒå°±æ˜¯æ ¹æ®å¼‚å¸¸å¯¹è±¡ï¼Œå»æ„å»ºå‡º"),s("code",[t._v("CodeMsg")]),t._v("å¯¹è±¡ï¼Œå°±ä¸ä¸€ä¸€è´´å‡ºæ¥äº†ï¼Œæ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹å“Ÿ")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼ é€’é¢„å®šä¹‰çš„æšä¸¾ Msg")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithStatusMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exception "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithCodeMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewWithMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¼ é€’é¢„å®šä¹‰çš„æšä¸¾ Code")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithStatusCode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exception "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithStatusMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Code2Msg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[s("strong",[t._v("ç»™ä»–ä¸€äº›å¥½ç”¨çš„æ–¹æ³•")])])]),t._v(" "),s("p",[t._v("æ—¢ç„¶æƒ³è¦ä½œä¸ºå¼‚å¸¸å¯¹è±¡ï¼Œæ ¸å¿ƒåªéœ€è¦å®ç°erroræ¥å£å³å¯ï¼Œé‚£å®ƒéƒ½æœ‰ä»€ä¹ˆæ–¹æ³•å‘¢ï¼Ÿ")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ ‡å‡†åº“çš„ error æ¥å£")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è·Ÿè¿›å»çœ‹çœ‹ï¼Œå‘€ï¼åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹Ÿå¤ªå¥½å®ç°äº†å•Šï¼ï¼ï¼é‚£å°±å¥½åŠå’¯~")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Error å®ç° error æ¥å£")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("Exception"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("S"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®šä¹‰å¥½ç”¨äºè‡ªå®šä¹‰errorçš„ä¸€äº›ç»“æ„ä½“äº†ã€‚å¯æ˜¯æˆ‘ä»¬è¿˜ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Œå»å¤„ç†å¼‚å¸¸å‹’ã€‚")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬å…ˆæ¥çœ‹å¦‚ä½•ç»Ÿä¸€å¤„ç† HTTP Handler ä¸­å‡ºç°çš„å¼‚å¸¸ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-http-å‡ºç°å¼‚å¸¸"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-http-å‡ºç°å¼‚å¸¸"}},[t._v("#")]),t._v(" ï¼ˆ2ï¼‰HTTP å‡ºç°å¼‚å¸¸")]),t._v(" "),s("h4",{attrs:{id:"_1ã€å¦‚ä½•å¤„ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€å¦‚ä½•å¤„ç†"}},[t._v("#")]),t._v(" 1ã€å¦‚ä½•å¤„ç†")]),t._v(" "),s("p",[t._v("å› ä¸ºæ˜¯ç”¨"),s("code",[t._v("Ginå°è£…çš„HTTP Serveice")]),t._v("ï¼Œæ‰€ä»¥ï¼Œæˆ‘è¿™é‡Œä»…ä»¥å¤„ç†Ginçš„Handlerå‡ºç°çš„å¼‚å¸¸ä¸ºä¾‹ï¼Œå…¶ä½™çš„å¤„ç†æ€è·¯ç±»ä¼¼ï¼š")]),t._v(" "),s("p",[t._v("å¦‚æœæŒ‰ç½‘ä¸Šæ‰€è¯´xxè®¾è®¡æ¨¡å¼æ¥è¯´çš„è¯ï¼Œè¿™é‡Œçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç”¨åˆ°äº†ï¼š"),s("strong",[t._v("è£…é¥°å™¨æ¨¡å¼")])]),t._v(" "),s("p",[t._v("ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼ï¼Ÿä¸çŸ¥é“æ²¡å…³ç³»ï¼Œä¸ç”¨ç®¡é‚£äº›é«˜å¤§ä¸Šçš„åå­—ï¼Œåªè¦çŸ¥é“æ ¸å¿ƒæ€æƒ³ï¼Œæˆ‘æ€ä¹ˆç”¨ä¸éƒ½è¡Œï¼Œæ˜¯å§~")]),t._v(" "),s("p",[t._v("è€Œè£…é¥°å™¨çš„æ ¸å¿ƒæ€æƒ³ï¼Œè¿˜æ˜¯æˆ‘è‡ªå·±ç†è§£çš„å•Šï¼š"),s("strong",[t._v("ææ¸…æ¥šæŠŠä»€ä¹ˆè£…é¥°æˆä»€ä¹ˆ")])]),t._v(" "),s("p",[t._v("è€Œæˆ‘ä»¬è¿™é‡Œï¼Œè¦å¤„ç†HTTTPçš„å¼‚å¸¸ï¼Œé‚£è‚¯å®šæ˜¯ç”¨æ¥è£…é¥°å’Œ"),s("code",[t._v("HTTPçš„Handler")]),t._v("ç›¸å…³çš„ä¸œè¥¿å’¯ã€‚é‚£å…ˆçœ‹çœ‹"),s("code",[t._v("Ginæ¡†æ¶å°è£…çš„HTTP Handler")]),t._v("é•¿ä»€ä¹ˆæ ·ï¼š")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// HandlerFunc defines the handler used by gin middleware as return value.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" HandlerFunc "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("Context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("çŸ¥é“å®ƒçš„HandlerFunc é•¿è¿™æ ·åï¼Œé‚£å’±ä»¬è‡³å°‘å¯ä»¥å¾—å‡ºä¸€ä¸ªä¿¡æ¯ï¼šç»è¿‡è£…é¥°åï¼Œé•¿æˆè¿™ä¸ªæ ·å­ã€‚")]),t._v(" "),s("p",[t._v("åŠ ä¸ŠGinçš„åŒ…åï¼Œä¹Ÿå°±æ˜¯ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/73428cabe28246f8bf75ba564da5ab3c~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20230226165219439"}})]),t._v(" "),s("p",[t._v("çœ‹å®Œäº†å›¾ï¼Œå¦‚æœæˆ‘ä»¬å†çŸ¥é“è¦è£…é¥°å•¥ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥å†™ä»£ç äº†ã€‚æ˜¯çš„ï¼Œç»§ç»­è·Ÿä¸Šæˆ‘çš„æ€è·¯ã€‚")]),t._v(" "),s("p",[t._v("å¦‚æœä½ å†å€’å›å»çœ‹ä¸Šé¢æˆ‘ä»¬è§‰å¾—è¿˜ä¸å¤Ÿä¼˜é›…çš„çš„ä»£ç ï¼Œä½ è‚¯å®šåˆèƒ½æƒ³èµ·é‚£ä¸ª "),s("code",[t._v("err != nil")]),t._v("ï¼Œé‚£ä¸ªç‹°ç‹çš„ error ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½æŠŠé‚£ä¸ªï¼Œä¼¤æˆ‘å¾ˆæ·±ï¼Œå´åˆæƒ¹ä¸èµ·çš„"),s("code",[t._v("err != nil")]),t._v("çš„æƒ…å½¢ï¼Œæ”¾å…¥è£…é¥°å™¨å¤„ç†å‘¢ï¼ŸæŒ‰è¿™æ ·çš„æƒ³æ³•ï¼Œå†æ¥ç”»ä¸€å¹…å›¾çœ‹çœ‹ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0acb1582b4ff47ca96a9c3a976eb1644~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20230226170026645"}})]),t._v(" "),s("p",[t._v("çœ‹å®Œäº†å›¾ï¼ŒçŸ¥é“äº†å¤§è‡´æ€è·¯ã€‚é‚£æˆ‘ä»¬å°±æ¥å†™ä»£ç å’¯~")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ–¹ä¾¿ä¸‹æ–‡ä½¿ç”¨ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°ç±»å‹")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" AppHandler "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("gin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// GinErrWrapper ç”¨äºç»Ÿä¸€å¤„ç†æ§åˆ¶å±‚ error")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("GinErrWrapper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("handler AppHandler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("gin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("gin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      log "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" zap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("L")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Named")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GinErrWrapper"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       \n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1ã€è°ƒç”¨ Handler æ–¹æ³•çš„é€»è¾‘")]),t._v("\n      err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("recover")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Infof")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Panic: %v"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusInternalServerError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Bad")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("INTERNAL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Errorf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"æ‹¦æˆªåˆ°å¼‚å¸¸ï¼š%s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2ã€æ¥åˆ°è¿™é‡Œã€‚err è‚¯å®šæ˜¯æœ‰å€¼çš„å’¯")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" e "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exception"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n         c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusBadRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CodeMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿˜å¯è¿›è¡Œå…¶ä»– Case å› ä¸ºæˆ‘ç»™grpcè°ƒç”¨çš„errç”¨æ–¹æ³•GrpcErrWrapperåŒ…è£…äº†")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰€ä»¥ä» æ§åˆ¶å±‚çš„errorï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ custom.Exception")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n         c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusInternalServerError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Bad")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("INTERNAL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("çœ‹å®Œäº†ä»£ç ï¼Œå…¶å®ä¹Ÿæ²¡å¤šéš¾æ˜¯å§ã€‚å¯ä»¥çœ‹åˆ°ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("è£…é¥°å™¨çš„å…¥å‚å’Œå‡ºå‚ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯å†ææ¸…æ¥šï¼Œè¦"),s("strong",[t._v("æŠŠè°è£…é¥°æˆè°")]),t._v("ï¼Ÿ")]),t._v(" "),s("li",[t._v("åˆšè¿›å…¥è£…é¥°å™¨ï¼Œæˆ‘ä»¬å°±å»è°ƒç”¨äº†"),s("strong",[t._v("çœŸæ­£çš„Handleré€»è¾‘")]),t._v("ï¼Œä¼šè¿”å›ä¸€ä¸ª err å€¼ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£å°±è¯´æ˜æ­£å¸¸å’¯ï¼Œé‚£å°±ä¸éœ€è¦è£…é¥°äº†å˜›ã€‚")]),t._v(" "),s("li",[t._v("èƒ½åˆ°åé¢è£…é¥° error çš„é€»è¾‘ï¼Œé‚£è¯´æ˜"),s("strong",[t._v("è‚¯å®šæœ‰erroräº†")]),t._v("ã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­ï¼Œå…·ä½“"),s("strong",[t._v("æ˜¯å“ªä¸€ç§ err")]),t._v("ï¼Œæ˜¯è‡ªå®šä¹‰çš„å—ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£å°±å¯ä»¥å–å‡ºè‡ªå®šä¹‰å¼‚å¸¸çš„æ¶ˆæ¯äº†å’¯ã€‚ä¸æ˜¯å‘¢ï¼Ÿåˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ")])]),t._v(" "),s("p",[t._v("è¿™ä¸‹ï¼Œç®—æ˜¯äº†è§£æ€è·¯äº†å§ï¼Œæ¥çœ‹çœ‹å¤„ç†åï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚")]),t._v(" "),s("h4",{attrs:{id:"_2ã€å¤„ç†å"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€å¤„ç†å"}},[t._v("#")]),t._v(" 2ã€å¤„ç†å")]),t._v(" "),s("p",[t._v("æ¥çœ‹çœ‹ï¼Œç°åœ¨æˆ‘ä»¬çš„"),s("code",[t._v("HTTP Handler")]),t._v("ä¸­ï¼Œæ˜¯æ€æ ·çš„ï¼Œè¿˜æ˜¯æ‹¿ç™»å½•æ¥ä¸¾ä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Login éœ€è¦ç»è¿‡è£…é¥°ï¼šr.POST("/login/", exception.GinErrWrapper(h.Login))')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("h "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("Handler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Login")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("gin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\treq "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewLoginAndRegisterRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1ã€æ¥æ”¶å‚æ•°")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Bind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" exception"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithStatusCode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ERROR_ARGS_VALIDATE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2ã€è¿›è¡Œæ¥å£è°ƒç”¨")]),t._v("\n\tresp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Login")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" exception"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("GrpcErrWrapper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3ã€æ²¡æœ‰errï¼Œæ­£å¸¸å“åº”")]),t._v("\n\tc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusOK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tloginAndRegisterResp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tCodeMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("       custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewWithCode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OPERATE_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\tTokenResponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("å’Œä¹‹å‰çš„ä»£ç æ¯”èµ·æ¥ï¼Œæ˜¯ä¸æ˜¯å°±å°‘äº†å¾ˆå¤š err å¤„ç†äº†ï¼Ÿä¸ä¿¡ä½ å¾€ä¸Šçœ‹çœ‹ã€‚")]),t._v(" "),s("p",[t._v("è‡³äºæˆ‘ä»¬çš„è¿”å›çš„errå€¼ï¼Œä¸å°±ç”¨ä¸Šäº†æˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸å¯¹è±¡äº†å—ï¼Ÿå½“ç„¶ï¼Œä½ ä¸ä½¿ç”¨ï¼Œä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚ç”šè‡³ä½ è¿˜å¯ä»¥å†ç»§ç»­å®šä¹‰å…¶ä»–çš„å¼‚å¸¸å¯¹è±¡ã€‚ä½ åªéœ€è¦åœ¨è£…é¥°å™¨ä¸­ï¼Œç»§ç»­"),s("strong",[t._v("æ·»åŠ  case")]),t._v(" å³å¯")]),t._v(" "),s("p",[t._v("è‡³æ­¤ï¼Œåº”è¯¥äº†è§£äº†æˆ‘ä»¬å¼‚å¸¸å¤„ç†çš„æ€è·¯ã€‚æˆ‘ä»¬è¶çƒ­æ‰“é“ï¼ŒæŠŠè¿›è¡Œ"),s("strong",[t._v("GRPCè°ƒç”¨çš„å¼‚å¸¸")]),t._v("ä¹Ÿå¤„ç†ä¸€ä¸‹ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_3-grpcå‡ºç°å¼‚å¸¸"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-grpcå‡ºç°å¼‚å¸¸"}},[t._v("#")]),t._v(" ï¼ˆ3ï¼‰GRPCå‡ºç°å¼‚å¸¸")]),t._v(" "),s("h4",{attrs:{id:"_1ã€å¦‚ä½•å¤„ç†-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€å¦‚ä½•å¤„ç†-2"}},[t._v("#")]),t._v(" 1ã€å¦‚ä½•å¤„ç†")]),t._v(" "),s("p",[t._v("è¿™é‡Œä¹Ÿæ˜¯ä½¿ç”¨è£…é¥°å™¨çš„æ–¹å¼æ¥åšçš„ã€‚ä»ä¸Šé¢çš„ä½¿ç”¨ä½ åº”è¯¥å·²ç»å‘ç°äº†ã€‚")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// GrpcErrWrapper ç”¨äºåŒ…è£… GPRC è°ƒç”¨äº§ç”Ÿçš„ err")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("GrpcErrWrapper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("custom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Exception "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1ã€é€šè¿‡æ­¤æ–¹æ³•ï¼Œä¸€å®šèƒ½å¤Ÿå°†errè½¬æ¢ä¸º grpc è°ƒç”¨äº§ç”Ÿçš„å¼‚å¸¸")]),t._v("\n   s "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Convert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n   log "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" zap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("L")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Named")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GrpcErrWrapper"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Errorf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"æ‹¦æˆªåˆ°å¼‚å¸¸ï¼š%s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨é€šè¿‡åŒ…è£…æˆ è‡ªå®šä¹‰å¼‚å¸¸ï¼Œç»Ÿä¸€åœ¨ gin ä¸­è¿›è¡Œæ‹¦æˆªå¤„ç†")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithStatusMsg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("çœ‹æ–¹æ³•å®ç°ï¼Œæˆ‘è¿™é‡Œä¹Ÿæ˜¯ç»™å®ƒ"),s("strong",[t._v("è½¬æ¢ä¸ºäº†è‡ªå®šä¹‰çš„å¼‚å¸¸")]),t._v("ã€‚ç„¶åè¿›å…¥ä¸Šé¢HTTPçš„å¤„ç†errçš„è£…é¥°å™¨ä¸­ï¼Œç»Ÿä¸€å¤„ç†ã€‚ä»£ç ç®€å•ï¼Œçœ‹æ€è·¯å³å¯~")]),t._v(" "),s("p",[t._v("ä½†æ˜¯çœ‹å®Œäº†ä»£ç ï¼Œä½ å¯èƒ½æœ‰ç‚¹ç–‘æƒ‘ï¼Œè¿›è¡ŒGRPCè°ƒç”¨ä¸šåŠ¡æ–¹æ³•ã€‚å¦‚æœåœ¨ç¼–å†™ä¸šåŠ¡æ–¹æ³•æ—¶ï¼Œå°±ä»¥è‡ªå®šä¹‰å¼‚å¸¸"),s("code",[t._v("ï¼ˆcode + msgï¼‰")]),t._v("è¿”å›äº†ï¼Œé‚£å°±ä¼šè¿”å›è‡ªå®šä¹‰erroré¸­ï¼Œå°±ç®—errorçœŸçš„ ä¸æ˜¯ nilï¼Œå®ƒçš„å€¼ä¸ä¹Ÿä¼šåœ¨æˆ‘ä»¬çš„Handlerä¸­å—ï¼Ÿä¸æ˜¯å·²ç»ç»Ÿä¸€å¤„ç†äº†å—ï¼Ÿä¸ºä»€ä¹ˆè¿˜éœ€è¦æˆ‘ä»¬è‡ªå·±å¤„ç†ä¸€éå‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("å“ˆå“ˆå“ˆï¼Œæ¥ç¢°ä¸ªæ¯ï¼Œæˆ‘å†ç»§ç»­è¯´~ğŸ»ã€‚ä½ è¿™ç®€ç›´å’Œæˆ‘å½“æ—¶çš„æƒ³æ³•ä¸€æ¨¡ä¸€æ ·å•Šã€‚é‚£æˆ‘ä¸ºä»€ä¹ˆè¿˜è¦è£…é¥°ä¸€éå‘¢ï¼Ÿè¿™å°±å¾—æåˆ°ä½¿ç”¨GRPCæ¡†æ¶è¿›è¡Œrpcè°ƒç”¨æ—¶ï¼Œå®ƒçš„ç»Ÿä¸€å¼‚å¸¸å¤„ç†äº†ã€‚")]),t._v(" "),s("h4",{attrs:{id:"_2ã€grpcæ¡†æ¶å¼‚å¸¸å¤„ç†çš„å¤§è‡´æ€è·¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€grpcæ¡†æ¶å¼‚å¸¸å¤„ç†çš„å¤§è‡´æ€è·¯"}},[t._v("#")]),t._v(" 2ã€GRPCæ¡†æ¶å¼‚å¸¸å¤„ç†çš„å¤§è‡´æ€è·¯")]),t._v(" "),s("p",[t._v("æˆ‘è¿™é‡Œåªæ˜¯è¯´å¼‚å¸¸å¤„ç†çš„å¤§è‡´æ€è·¯ï¼Œå¹¶ä¸æ˜¯è¯´GRPCçš„åŸç†çš„å“ˆ"),s("code",[t._v("ï¼ˆå½“ç„¶ï¼Œè¿™ä¸ä¸»è¦æ˜¯å› ä¸ºè€å¼Ÿä¹Ÿä¸æ˜¯å¾ˆäº†è§£å—~ï¼‰")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("é‚£ä»å“ªé‡Œå¼€å§‹å‘¢ï¼Ÿå°±ä»å®ƒå¤„ç†ä¸€ç³»åˆ—é€»è¾‘åï¼Œè¿”å›çš„ err è¯´èµ·å§ã€‚åœ¨è¿›è¡Œäº†ä¸€ç³»åˆ—çš„å¤„ç†åï¼Œä¸ç®¡æˆåŠŸä¸å¦å§ï¼Œç»ˆäºè¦å¼€å§‹è¿”å›erräº†ã€‚")]),t._v(" "),s("ol",[s("li",[t._v("è¿”å›çš„errï¼Œä¼šç»è¿‡æ­¤æ–¹æ³•è¿›è¡Œ"),s("strong",[t._v("åŒ…è£…")]),t._v("ï¼š")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/87b66e32be4c45b5be905863302dc782~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20230226175216552"}})]),t._v(" "),s("p",[t._v("çœ‹è¿™ä¸ªæ–¹æ³•çš„æ€è·¯ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰é‚£ä¹ˆä¸€ä¸ä¸ç†Ÿæ‚‰çš„æ„Ÿè§‰ï¼Ÿå“ˆå“ˆå“ˆï¼Œæ˜¯çš„ï¼Œæˆ‘ä»¬é‚£é‡Œè£…é¥°å™¨çš„æ€è·¯ï¼Œå°±æ˜¯å€Ÿé‰´äº†è¿™é‡Œçš„å®ç°ã€‚")]),t._v(" "),s("p",[t._v("åœ¨ç»è¿‡ä¸€ç³»åˆ—å¤„ç†åï¼Œè¿”å›çš„errï¼Œå®ƒéƒ½ä¼šæŠŠä»–è½¬æ¢æˆ "),s("code",[t._v("status.Error")]),t._v("ï¼Œä¹Ÿå°±æ˜¯è¯´ã€‚ä¸ç®¡ä½ å½“æ—¶ç¼–å†™ä¸šåŠ¡é€»è¾‘çš„æ—¶å€™ï¼Œä½ è¿”å›çš„æ˜¯ä»€ä¹ˆerrorã€‚å®ƒéƒ½ä¼šæŠŠä»–å˜æˆ"),s("code",[t._v("status.Error")]),t._v(" ï¼Œå½“ç„¶ï¼Œå¦‚æœä½ äº†è§£åˆ°è¿™ä¸€ç‚¹ï¼Œä½ å¯èƒ½ç¼–å†™ä¸šåŠ¡é€»è¾‘çš„æ—¶å€™ï¼Œå¦‚æœæœ‰ errï¼Œä½ å°±ä¼šè¿”å›"),s("code",[t._v("status.Error")]),t._v("çš„é”™è¯¯ã€‚")]),t._v(" "),s("p",[t._v("å°±æ¯”å¦‚å½“ä½ ç”¨"),s("code",[t._v("protoc-gen-go-grpc")]),t._v("å·¥å…·æ ¹æ®"),s("code",[t._v("protobuf")]),t._v("å®šä¹‰ç”Ÿæˆä»£ç çš„æ—¶å€™ã€‚å®ƒä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„"),s("code",[t._v("UnimplementedServiceServer")]),t._v("å¯¹è±¡ã€‚")]),t._v(" "),s("p",[t._v("è¿™ä¸ªå¯¹è±¡ä¼šé»˜è®¤å®ç°ä½ å®šä¹‰çš„æ‰€æœ‰æ¥å£ï¼Œä½ çœ‹çœ‹å®ƒçš„ err è¿”å›å€¼ï¼Œè¿™ä¸å°±æ˜¯"),s("code",[t._v("status.Error")]),t._v("å—ï¼Ÿ")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UnimplementedServiceServer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Login")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("LoginAndRegisterRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("TokenResponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Errorf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("codes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Unimplemented"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"method Login not implemented"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("å“ˆå“ˆå“ˆï¼Œæ‰€ä»¥ï¼Œä½ çœ‹çœ‹ï¼Œå¦‚æœä½ åœ¨å®ç°GRPCæ–¹æ³•çš„æ—¶å€™ï¼Œä¸æ˜¯æŒ‰è¿™æ ·çš„æ ¼å¼è¿”å› err çš„ï¼Œæ˜¯ä¸æ˜¯è¿˜è¦éº»çƒ¦åˆ«äººç»™æˆ‘ä»¬å¤„ç†ä¸€éå‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("å½“ç„¶ï¼Œå®ƒå¹¶ä¸æ˜¯å®Œå…¨æ›¿æ¢æ‰ä½ çš„ err ä¿¡æ¯ï¼Œä»–ä¼šæ ¹æ®ä½ çš„ err ä¿¡æ¯ï¼Œæ¥æ„å»ºä¸€ä¸ª "),s("code",[t._v("status.Error")]),t._v("ï¼Œæ‰€ä»¥ï¼Œå¦‚æœåœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘çš„æ—¶å€™ï¼Œå®šä¹‰ä¸€äº›ä¿¡æ¯ï¼Œä¼šè¢«å®ƒä¸­é—´å¤„ç†ä¸€ä¸‹ã€‚å¯èƒ½ä¼šä¸¢å¤±éƒ¨åˆ†ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ï¼ŒåŸæœ¬å®šä¹‰çš„çŠ¶æ€ç ã€‚")]),t._v(" "),s("p",[t._v("æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œåœ¨è¿›è¡ŒGRPCè°ƒç”¨çš„æ—¶å€™ï¼Œä¼šå°†è¿”å› err çš„å¼‚å¸¸ï¼Œç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æšä¸¾çš„æ¶ˆæ¯æç¤ºï¼Œé‚£ä¹ˆä¹‹åæˆ‘ä»¬å°±èƒ½å¤Ÿç”¨å“ªä¸ªæ¶ˆæ¯æç¤ºï¼Œå»æ‰¾å‡ºå¯¹åº”çš„çŠ¶æ€ç ã€‚è¿›è€Œç»™å‡ºæ­£ç¡®çš„æç¤ºã€‚")]),t._v(" "),s("p",[t._v("å½“ç„¶å•Šï¼Œä¹Ÿå¯ä»¥å°†æ­¤æ¶ˆæ¯æ”¾å…¥status.Errorçš„é¢å¤–ä¿¡æ¯ä¸­ã€‚è¯´åˆ°è¿™ï¼Œä½ å‘ç°æˆ‘ä¸€ç›´æåˆ°çš„ "),s("code",[t._v("status.Error")]),t._v("ï¼Œè¿™ç©æ„åˆ°åº•æ˜¯å•¥å˜›ï¼")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("statusåŒ…ä¸‹é¢çš„æœ‰ä»€ä¹ˆï¼Ÿ")])]),t._v(" "),s("p",[t._v("å¦‚æœä½ ç‚¹è¿›å®ƒçš„ status åŒ…ä¸­ï¼Œä½ ä¼šçœ‹åˆ°å¥½äº›æ–¹æ³•ã€‚æ¯”å¦‚ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0291a7f97d34a2a9f3d42bd61e33aeb~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20230226180931049"}})]),t._v(" "),s("p",[t._v("ä½ çœ‹çœ‹å•Šï¼Œä»–è¿™äº›æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¾ˆçœ¼ç†Ÿå‘¢ï¼Ÿä½ å¾€ä¸Šçœ‹çœ‹ï¼Œæˆ‘ä»¬å®šä¹‰çš„ç»“æ„ä½“ï¼Œæ˜¯ä¸æ˜¯æä¾›äº†å’Œä»–å¾ˆç±»ä¼¼çš„æ–¹æ³•ï¼Ÿ")]),t._v(" "),s("p",[t._v("åªä¸è¿‡ä»–è¿™é‡Œå¼•å…¥çš„æ˜¯"),s("code",[t._v("Status")]),t._v("å¯¹è±¡ï¼Œæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ˜¯å®ƒ"),s("code",[t._v("internal")]),t._v("å†…éƒ¨åŒ…ä¸­çš„Statuså¯¹è±¡ã€‚å¦‚æœä½ å†è·Ÿè¿›ä¸€æ­¥ï¼šé™¤äº†çœ‹åˆ°é‚£äº›å¥½ç”¨çš„æ–¹æ³•å¤–ï¼Œæœ€ä¸»è¦æœ‰ä¸¤ä¸ªç»“æ„ä½“ï¼š")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Status represents an RPC status code, message, and details.  It is immutable")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// and should be created with New, Newf, or FromProto.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" Status "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\ts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("spb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Status\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Error wraps a pointer of a status proto. It implements error and Status,")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// and a nil *Error should never be returned by this package.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" Error "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\ts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("Status\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("ä½ å‘ç°ï¼Œè¿™é‡Œçš„ Status å¯¹è±¡ï¼Œè¿˜ä¾èµ–äº†ä¸€ä¸ª "),s("code",[t._v("*spb.Status")]),t._v("å¯¹è±¡ï¼Œå¦‚æœå†è·Ÿå…¥ï¼Œä½ ä¼šå‘ç°ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4469c96553e24cb8b4fb1cda1b44fa25~tplv-k3u1fbpfcp-zoom-1.image",alt:"image-20230226181700271"}})]),t._v(" "),s("p",[t._v("è¿™æ˜¯å®˜æ–¹"),s("code",[t._v("Protobuf")]),t._v("ç”Ÿæˆçš„ä»£ç ï¼Œçœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿæ˜¯ä¸æ˜¯ä¹Ÿå¾ˆçœ¼ç†Ÿï¼Ÿ"),s("code",[t._v("Codeå’ŒMassage")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("å¥½äº†ï¼Œå¤§è‡´è·Ÿä½ ä»‹ç»å®Œäº†è¿™å¥½å‡ ä¸ªå¯¹è±¡ã€‚æ¥ä¸æˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸å¯¹è±¡ä¸€èµ·çœ‹çœ‹ï¼Œæ€»ç»“ä¸€ä¸‹ã€‚")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("æ€»ç»“ä¸€ä¸‹")])]),t._v(" "),s("ul",[s("li",[t._v("æˆ‘ä»¬çš„"),s("strong",[t._v("CodeMsg")]),t._v("å¯¹è±¡ï¼Œå’ŒGRPCæ¡†æ¶çš„Statuså¯¹è±¡å¾ˆç±»ä¼¼ï¼Œé‡Œé¢ä¸»è¦æœ‰"),s("code",[t._v("Code+Msg")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("æˆ‘ä»¬çš„"),s("strong",[t._v("Exception")]),t._v("å¯¹è±¡ï¼Œå’Œè¿™é‡Œçš„"),s("code",[t._v("Error")]),t._v("å¯¹è±¡å¾ˆç±»ä¼¼ï¼Œéƒ½æ˜¯å»å®ç°äº†"),s("code",[t._v("error")]),t._v("æ¥å£ã€‚")]),t._v(" "),s("li",[t._v("æˆ‘ä»¬çš„"),s("strong",[t._v("StatusCode")]),t._v("æšä¸¾ï¼Œå’Œè¿™é‡Œé¢æœ‰ä¸€ä¸ª"),s("code",[t._v("Code")]),t._v("æšä¸¾å¾ˆç±»ä¼¼ï¼Œéƒ½æ˜¯ä½¿ç”¨ Map æ¥å®šä¹‰çš„ã€‚")]),t._v(" "),s("li",[t._v("æˆ‘ä»¬"),s("strong",[t._v("ç»Ÿä¸€å¼‚å¸¸å¤„ç†çš„è£…é¥°å™¨")]),t._v("æ€è·¯ï¼Œå’Œè¿™é‡Œé¢çš„ "),s("code",[t._v("toRPCErr")]),t._v("å¾ˆç±»ä¼¼ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("æ‰€ä»¥ï¼Œè‡³æ­¤ï¼Œæˆ‘å°±èƒ½è¯´ï¼ŒGRPCå®˜æ–¹çš„errorå¤„ç†ï¼Œæˆ‘æ”¾åœ¨HTTPçš„Handlerä¸­ï¼Œä¸€æ ·çš„å¥½ç”¨äº†å§~")])]),t._v(" "),s("h3",{attrs:{id:"_4-è¿˜æ˜¯å¾ˆéº»çƒ¦çš„åœ°æ–¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-è¿˜æ˜¯å¾ˆéº»çƒ¦çš„åœ°æ–¹"}},[t._v("#")]),t._v(" ï¼ˆ4ï¼‰è¿˜æ˜¯å¾ˆéº»çƒ¦çš„åœ°æ–¹")]),t._v(" "),s("p",[t._v("å›åˆ°æ–‡ç« çš„å¼€å¤´ï¼Œä¸ºä»€ä¹ˆè¯´goçš„errorè¢«å¾ˆå¤šäººåæ§½ï¼Œæˆ‘è‡ªå·±è®¤ä¸ºçš„ï¼Œæœ€æ ¸å¿ƒçš„ç‚¹å°±æ˜¯ï¼š")]),t._v(" "),s("p",[s("strong",[t._v("error æ˜¯å°±æ˜¯ä¸€ä¸ª value")]),t._v("ï¼Œé™¤éä½ ä½¿ç”¨ "),s("code",[t._v("panic(err)")]),t._v("ï¼Œå¯èƒ½ä¼šæ‰“å°ä¸€äº›å †æ ˆä¿¡æ¯ä»¥å¤–ï¼Œå‡ ä¹å¾ˆéš¾çœ‹åˆ°å †æ ˆä¿¡æ¯ã€‚å’Œå¾ˆå¤šå…¶ä»–çš„è¯­è¨€ç›¸æ¯”èµ·æ¥ï¼Œä¹Ÿå°±å¾ˆéš¾å®šä½åˆ°é—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚ä¼šå¢åŠ ç¨‹åºå‘˜çš„è°ƒè¯•æˆæœ¬ã€æ—¶é—´æˆæœ¬ã€‚")]),t._v(" "),s("p",[t._v("å½“ç„¶å•Šï¼Œä¹Ÿæœ‰å¾ˆå¤šå¥½çš„åœ°æ–¹ï¼Œå’Œå…¶ä»–åœ°æ–¹è¢«ä¼—å¤šcoderè®¨è®ºçš„ã€‚è¿™é‡Œåªæ˜¯è¯´è¯´æˆ‘çš„ä¸ªäººçœ‹æ³•ï¼Œä¸å–œå‹¿å–·å“ŸğŸ˜~")]),t._v(" "),s("p",[t._v("æ‰€ä»¥æˆ‘è®¤ä¸ºï¼Œè¿™æ ·çš„å¼‚å¸¸å¤„ç†ï¼Œåªæ˜¯åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè®©ä»£ç ä¼˜é›…äº†è®¸å¤šï¼Œæ ¹æœ¬çš„åŸå› è¿˜æ˜¯éœ€è¦è‡ªå·±èŠ±æ—¶é—´å®šä½ã€‚åæœŸå¯èƒ½ä¼šæƒ³åŠæ³•åŠ ä¸Šèƒ½å¤Ÿå°†å †æ ˆä¿¡æ¯æš´éœ²å‡ºæ¥çš„åº“ã€‚æºå¸¦ä¸Šä¸€äº›æ ¹å› ã€‚å°½é‡å‡å°‘å‡ºç°é—®é¢˜çš„è°ƒè¯•æˆæœ¬~")]),t._v(" "),s("p",[t._v("æ¬¢è¿å¤§å®¶è®¨è®ºé¸­~")])])}),[],!1,null,null,null);s.default=r.exports}}]);